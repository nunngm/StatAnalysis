totalDur = function(df,byActivity = F){ ##this function takes whatever data frame you give it and summarizes it
if(dim(df)[1]==0){
return(0)
}
df$Duration = times(paste0(df$Duration,":00"))
x = integer(nlevels(df[,1+byActivity]))
names(x)= levels(df[,1+byActivity])
levels(df[,1+byActivity])[1]= paste0(levels(df[,1+byActivity])[1],"_")
for(i in 1:nlevels(df[,1+byActivity])){
x[i] = sum(df$Duration[grep(levels(df[,1+byActivity])[i],df[,1+byActivity])])
}
x
}
startDate = as.Date.character(startDate, format = "%Y-%m-%d")
endDate = as.Date.character(endDate,format = "%Y-%m-%d")
mat =data.frame()
mid = as.Date(NA)[-1]
for (i in startDate:endDate){
x = as.Date.numeric(i,format = "%Y-%m-%d",origin = "1970-01-01")
mid = c(mid,x)
mat = rbind(mat,totalDur(mydata[grepl(x,mydata$From),],byActivity))
#rownames(mat)[i-as.integer(startDate)+1] = as.character(x)
}
View(mat)
mat =mat*24
mat = cbind(mid,mat)
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
df =mydata
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
daysOfWeek = c("Monday","Tuesday","Wednesday","Thursday","Friday")
summ = mat[grep(paste(daysOfWeek, collapse = "|"),weekdays(mat$Dates)),]
print("This is the average for weekdays:")
pie(colMeans(summ[,2:length(summ)]))
par(mfrow=c(2,2))
plot(mat$Dates,mat[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("All Days")
for (i in 2:length(mat)){
lines(mat$Dates,mat[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
pie(colMeans(summ[,2:length(summ)]))
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2,text.width =2)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2,text.width =1)
pie(colMeans(summ[,2:length(summ)]))
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2,text.width =1)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =1,pt.cex =0.5, ncol =2,text.width =1)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =1,pt.cex =0.25, ncol =2,text.width =1)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.6,pt.cex =0.25, ncol =2,text.width =1)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.6,pch =1,pt.cex =0.25, ncol =2,text.width =1)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75,pch =1,pt.cex =0.1, ncol =2,text.width =1)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75,pch =1,pt.cex =0, ncol =2,text.width =1)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75 ncol =2,text.width =1, font.size =14)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =1, font.size =14)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =1, font =14)
summaryByDay(mydata,"2018-11-01","2018-12-01", byActivity = T)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
summaryByDay = function(df, startDate, endDate,byActivity=F){
startDate = as.Date.character(startDate, format = "%Y-%m-%d")
endDate = as.Date.character(endDate,format = "%Y-%m-%d")
mat =data.frame()
mid = as.Date(NA)[-1]
for (i in startDate:endDate){
x = as.Date.numeric(i,format = "%Y-%m-%d",origin = "1970-01-01")
mid = c(mid,x)
mat = rbind(mat,totalDur(df[grepl(x,df$From),],byActivity))
#rownames(mat)[i-as.integer(startDate)+1] = as.character(x)
}
mat =mat*24
mat = cbind(mid,mat)
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
#mat = mat[rowSums(mat[2:length(mat)])!=0,]
daysOfWeek = c("Monday","Tuesday","Wednesday","Thursday","Friday")
summ = mat[grep(paste(daysOfWeek, collapse = "|"),weekdays(mat$Dates)),]
print("This is the average for weekdays:")
par(mfrow=c(2,2))
plot(mat$Dates,mat[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("All Days")
for (i in 2:length(mat)){
lines(mat$Dates,mat[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
pie(colMeans(summ[,2:length(summ)]))
}
summaryByDay(mydata,"2018-11-01","2018-12-01", byActivity = T)
legend(-1,-1,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
par(xpd=TRUE)
legend(-1,-1,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
legend(0,-1,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
par(xpd=TRUE)
legend(-1,-1,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
legend(-1,-1,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
legend(-1,-2,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
legend(-1,-2,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
legend(-10,-10,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
par(xpd=TRUE)
legend(-10,-10,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
legend(0,0,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
par(xpd=TRUE)
legend(0,0,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
summaryByDay(mydata,"2018-11-01","2018-12-01", byActivity = T)
summaryByDay = function(df, startDate, endDate,byActivity=F){
startDate = as.Date.character(startDate, format = "%Y-%m-%d")
endDate = as.Date.character(endDate,format = "%Y-%m-%d")
mat =data.frame()
mid = as.Date(NA)[-1]
for (i in startDate:endDate){
x = as.Date.numeric(i,format = "%Y-%m-%d",origin = "1970-01-01")
mid = c(mid,x)
mat = rbind(mat,totalDur(df[grepl(x,df$From),],byActivity))
#rownames(mat)[i-as.integer(startDate)+1] = as.character(x)
}
mat =mat*24
mat = cbind(mid,mat)
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
#mat = mat[rowSums(mat[2:length(mat)])!=0,]
daysOfWeek = c("Monday","Tuesday","Wednesday","Thursday","Friday")
summ = mat[grep(paste(daysOfWeek, collapse = "|"),weekdays(mat$Dates)),]
print("This is the average for weekdays:")
par(mfrow=c(2,2))
plot(mat$Dates,mat[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("All Days")
for (i in 2:length(mat)){
lines(mat$Dates,mat[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
par(xpd=TRUE)
legend(-10,-10,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
pie(colMeans(summ[,2:length(summ)]))
}
summaryByDay(mydata,"2018-11-01","2018-12-01", byActivity = T)
legend(0,-5,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
summaryByDay = function(df, startDate, endDate,byActivity=F){
startDate = as.Date.character(startDate, format = "%Y-%m-%d")
endDate = as.Date.character(endDate,format = "%Y-%m-%d")
mat =data.frame()
mid = as.Date(NA)[-1]
for (i in startDate:endDate){
x = as.Date.numeric(i,format = "%Y-%m-%d",origin = "1970-01-01")
mid = c(mid,x)
mat = rbind(mat,totalDur(df[grepl(x,df$From),],byActivity))
#rownames(mat)[i-as.integer(startDate)+1] = as.character(x)
}
mat =mat*24
mat = cbind(mid,mat)
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
#mat = mat[rowSums(mat[2:length(mat)])!=0,]
daysOfWeek = c("Monday","Tuesday","Wednesday","Thursday","Friday")
summ = mat[grep(paste(daysOfWeek, collapse = "|"),weekdays(mat$Dates)),]
print("This is the average for weekdays:")
par(mfrow=c(2,2))
plot(mat$Dates,mat[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("All Days")
for (i in 2:length(mat)){
lines(mat$Dates,mat[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
par(xpd=TRUE)
legend(0,-5,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
pie(colMeans(summ[,2:length(summ)]))
}
summaryByDay(mydata,"2018-11-01","2018-12-01", byActivity = T)
summaryByDay = function(df, startDate, endDate,byActivity=F){
startDate = as.Date.character(startDate, format = "%Y-%m-%d")
endDate = as.Date.character(endDate,format = "%Y-%m-%d")
mat =data.frame()
mid = as.Date(NA)[-1]
for (i in startDate:endDate){
x = as.Date.numeric(i,format = "%Y-%m-%d",origin = "1970-01-01")
mid = c(mid,x)
mat = rbind(mat,totalDur(df[grepl(x,df$From),],byActivity))
#rownames(mat)[i-as.integer(startDate)+1] = as.character(x)
}
mat =mat*24
mat = cbind(mid,mat)
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
#mat = mat[rowSums(mat[2:length(mat)])!=0,]
daysOfWeek = c("Monday","Tuesday","Wednesday","Thursday","Friday")
summ = mat[grep(paste(daysOfWeek, collapse = "|"),weekdays(mat$Dates)),]
print("This is the average for weekdays:")
par(mfrow=c(2,2))
plot(mat$Dates,mat[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("All Days")
for (i in 2:length(mat)){
lines(mat$Dates,mat[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
par(xpd=TRUE)
legend(0,-5,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
pie(colMeans(summ[,2:length(summ)]))
}
summaryByDay(mydata,"2018-11-01","2018-12-01", byActivity = T)
summaryByDay = function(df, startDate, endDate,byActivity=F){
startDate = as.Date.character(startDate, format = "%Y-%m-%d")
endDate = as.Date.character(endDate,format = "%Y-%m-%d")
mat =data.frame()
mid = as.Date(NA)[-1]
for (i in startDate:endDate){
x = as.Date.numeric(i,format = "%Y-%m-%d",origin = "1970-01-01")
mid = c(mid,x)
mat = rbind(mat,totalDur(df[grepl(x,df$From),],byActivity))
#rownames(mat)[i-as.integer(startDate)+1] = as.character(x)
}
mat =mat*24
mat = cbind(mid,mat)
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
#mat = mat[rowSums(mat[2:length(mat)])!=0,]
daysOfWeek = c("Monday","Tuesday","Wednesday","Thursday","Friday")
summ = mat[grep(paste(daysOfWeek, collapse = "|"),weekdays(mat$Dates)),]
print("This is the average for weekdays:")
par(mfrow=c(2,2))
plot(mat$Dates,mat[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("All Days")
for (i in 2:length(mat)){
lines(mat$Dates,mat[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
par(xpd=TRUE)
legend(0,0,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
pie(colMeans(summ[,2:length(summ)]))
}
summaryByDay(mydata,"2018-11-01","2018-12-01", byActivity = T)
par(xpd=TRUE)
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
legend("topright"-1,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
legend("topright",y =-5,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
legend("topright",y =-0.5,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
legend("topright",y =-0.0001,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
summaryByDay = function(df, startDate, endDate,byActivity=F){
startDate = as.Date.character(startDate, format = "%Y-%m-%d")
endDate = as.Date.character(endDate,format = "%Y-%m-%d")
mat =data.frame()
mid = as.Date(NA)[-1]
for (i in startDate:endDate){
x = as.Date.numeric(i,format = "%Y-%m-%d",origin = "1970-01-01")
mid = c(mid,x)
mat = rbind(mat,totalDur(df[grepl(x,df$From),],byActivity))
#rownames(mat)[i-as.integer(startDate)+1] = as.character(x)
}
mat =mat*24
mat = cbind(mid,mat)
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
#mat = mat[rowSums(mat[2:length(mat)])!=0,]
daysOfWeek = c("Monday","Tuesday","Wednesday","Thursday","Friday")
summ = mat[grep(paste(daysOfWeek, collapse = "|"),weekdays(mat$Dates)),]
print("This is the average for weekdays:")
par(mfrow=c(2,2))
plot(mat$Dates,mat[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("All Days")
for (i in 2:length(mat)){
lines(mat$Dates,mat[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
par(xpd=TRUE)
legend("topright",y =-0.0001,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
pie(colMeans(summ[,2:length(summ)]))
}
summaryByDay(mydata,"2018-11-01","2018-12-01", byActivity = T)
summaryByDay = function(df, startDate, endDate,byActivity=F){
startDate = as.Date.character(startDate, format = "%Y-%m-%d")
endDate = as.Date.character(endDate,format = "%Y-%m-%d")
mat =data.frame()
mid = as.Date(NA)[-1]
for (i in startDate:endDate){
x = as.Date.numeric(i,format = "%Y-%m-%d",origin = "1970-01-01")
mid = c(mid,x)
mat = rbind(mat,totalDur(df[grepl(x,df$From),],byActivity))
#rownames(mat)[i-as.integer(startDate)+1] = as.character(x)
}
mat =mat*24
mat = cbind(mid,mat)
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
#mat = mat[rowSums(mat[2:length(mat)])!=0,]
daysOfWeek = c("Monday","Tuesday","Wednesday","Thursday","Friday")
summ = mat[grep(paste(daysOfWeek, collapse = "|"),weekdays(mat$Dates)),]
print("This is the average for weekdays:")
par(mfrow=c(2,2))
plot(mat$Dates,mat[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("All Days")
for (i in 2:length(mat)){
lines(mat$Dates,mat[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
par(xpd=TRUE)
legend("topright",y =-1,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
pie(colMeans(summ[,2:length(summ)]))
}
summaryByDay(mydata,"2018-11-01","2018-12-01", byActivity = T)
summaryByDay = function(df, startDate, endDate,byActivity=F){
startDate = as.Date.character(startDate, format = "%Y-%m-%d")
endDate = as.Date.character(endDate,format = "%Y-%m-%d")
mat =data.frame()
mid = as.Date(NA)[-1]
for (i in startDate:endDate){
x = as.Date.numeric(i,format = "%Y-%m-%d",origin = "1970-01-01")
mid = c(mid,x)
mat = rbind(mat,totalDur(df[grepl(x,df$From),],byActivity))
#rownames(mat)[i-as.integer(startDate)+1] = as.character(x)
}
mat =mat*24
mat = cbind(mid,mat)
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
#mat = mat[rowSums(mat[2:length(mat)])!=0,]
daysOfWeek = c("Monday","Tuesday","Wednesday","Thursday","Friday")
summ = mat[grep(paste(daysOfWeek, collapse = "|"),weekdays(mat$Dates)),]
print("This is the average for weekdays:")
par(mfrow=c(2,2))
plot(mat$Dates,mat[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("All Days")
for (i in 2:length(mat)){
lines(mat$Dates,mat[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
par(xpd=TRUE)
legend(0,0,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
pie(colMeans(summ[,2:length(summ)]))
}
summaryByDay(mydata,"2018-11-01","2018-12-01", byActivity = T)
summaryByDay = function(df, startDate, endDate,byActivity=F){
startDate = as.Date.character(startDate, format = "%Y-%m-%d")
endDate = as.Date.character(endDate,format = "%Y-%m-%d")
mat =data.frame()
mid = as.Date(NA)[-1]
for (i in startDate:endDate){
x = as.Date.numeric(i,format = "%Y-%m-%d",origin = "1970-01-01")
mid = c(mid,x)
mat = rbind(mat,totalDur(df[grepl(x,df$From),],byActivity))
#rownames(mat)[i-as.integer(startDate)+1] = as.character(x)
}
mat =mat*24
mat = cbind(mid,mat)
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
#mat = mat[rowSums(mat[2:length(mat)])!=0,]
daysOfWeek = c("Monday","Tuesday","Wednesday","Thursday","Friday")
summ = mat[grep(paste(daysOfWeek, collapse = "|"),weekdays(mat$Dates)),]
print("This is the average for weekdays:")
par(mfrow=c(2,2))
plot(mat$Dates,mat[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("All Days")
for (i in 2:length(mat)){
lines(mat$Dates,mat[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours",args.legend = list(x = ‚right‘, bty=’n‘, inset=c(-0.50,0), xpd = TRUE),)
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
par(xpd=TRUE)
#legend(,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
pie(colMeans(summ[,2:length(summ)]))
}
summaryByDay(mydata,"2018-11-01","2018-12-01", byActivity = T)
summaryByDay = function(df, startDate, endDate,byActivity=F){
startDate = as.Date.character(startDate, format = "%Y-%m-%d")
endDate = as.Date.character(endDate,format = "%Y-%m-%d")
mat =data.frame()
mid = as.Date(NA)[-1]
for (i in startDate:endDate){
x = as.Date.numeric(i,format = "%Y-%m-%d",origin = "1970-01-01")
mid = c(mid,x)
mat = rbind(mat,totalDur(df[grepl(x,df$From),],byActivity))
#rownames(mat)[i-as.integer(startDate)+1] = as.character(x)
}
mat =mat*24
mat = cbind(mid,mat)
colnames(mat)=c("Dates",levels(df[,1+byActivity]))
#mat = mat[rowSums(mat[2:length(mat)])!=0,]
daysOfWeek = c("Monday","Tuesday","Wednesday","Thursday","Friday")
summ = mat[grep(paste(daysOfWeek, collapse = "|"),weekdays(mat$Dates)),]
print("This is the average for weekdays:")
par(mfrow=c(2,2))
plot(mat$Dates,mat[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours")
title("All Days")
for (i in 2:length(mat)){
lines(mat$Dates,mat[,i],col = i)
}
legend("topright",legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.5, ncol =2)
plot(summ$Dates,summ[,2],type="n", ylim = c(0, max(mat[,2:length(mat)])+2), xlab= "Days", ylab ="Hours",args.legend = list(x = ‚right‘, bty=’n‘, inset=c(-0.50,0), xpd = TRUE),)
title("Week Days")
for (i in 2:length(summ)){
lines(summ$Dates,summ[,i],col = i)
}
par(xpd=TRUE)
legend(,legend = c(colnames(mat[,2:length(mat)])), fill = 2:length(mat), cex =0.75, ncol =2,text.width =0.5)
pie(colMeans(summ[,2:length(summ)]))
}
#Reset and read the data (row,col)
rm(list=ls())
#before running this program label blank wells "blank" and empty wells "empty"
makeAMATable = function(filename, everyHour=2,blankName="^blank.*"){
mydata <- read.table(filename,sep = ",", header=TRUE,row.names = 1, check.names = F)
rownames(mydata)= (0:(length(mydata[,1])-1))*15/60 #Make the row names representative of hours
#Fix column names
mydata = mydata[colnames(mydata)!="empty"] #remove columns labelled empty
#Mean subtract the mean of the blanks from each row
blankAvg = rowMeans(mydata[,grepl(pattern = blankName,colnames(mydata))])
mydata = mydata[,grep(pattern = blankName,colnames(mydata),invert =T)] - blankAvg
#Select only desired rows
###this shit doesn't work yet
mydata = mydata[as.numeric(rownames(mydata))%%everyHour==0,]
write.csv(mydata,paste0("analyzed_",filename))
mydata
}
mydata = makeAMATable("AMA-18-4.csv")
mydata = makeAMATable("AMA-18-4.csv")
#before running this program label blank wells "blank" and empty wells "empty"
makeAMATable = function(filename, everyHour=2,blankName="^blank.*"){
mydata <- read.table(filename,sep = ",", header=TRUE,row.names = 1, check.names = F)
rownames(mydata)= (0:(length(mydata[,1])-1))*15/60 #Make the row names representative of hours
#Fix column names
mydata = mydata[colnames(mydata)!="empty"] #remove columns labelled empty
#Mean subtract the mean of the blanks from each row
blankAvg = rowMeans(mydata[,grepl(pattern = blankName,colnames(mydata))])
mydata = mydata[,grep(pattern = blankName,colnames(mydata),invert =T)] - blankAvg
#Select only desired rows
###this shit doesn't work yet
mydata = mydata[as.numeric(rownames(mydata))%%everyHour==0,]
write.csv(mydata,paste0("analyzed_",filename))
mydata
}
filename = "AMA-18-4.csv"
mydata = makeAMATable("AMA-18-4.csv")
mydata <- read.table(filename,sep = ",", header=TRUE,row.names = 1, check.names = F)
mydata <- read.table(filename,sep = ",", header=TRUE,row.names = 1, check.names = F)
setwd("C:/Users/garre/OneDrive/Documents/Undergrad and Masters/Data/R WD/StatAnalysis")
mydata = makeAMATable("AMA-18-4.csv")
View(mydata)
best = mean(mydata[2,])
mydata[2,]
best = mydata[2,]
length(mydata)
row(mydata)
nrow(mydata)
for (i in 1:nrow(mydata)){}
for (i in 1:nrow(mydata)){best=rbind(best,best[1,])}
best= best[-1,]
mydata-best
best =mydata-best
best
View(best)
best = best+0.05
View(best)
write.csv(best,paste0("messed_",filename))
View(mydata)
