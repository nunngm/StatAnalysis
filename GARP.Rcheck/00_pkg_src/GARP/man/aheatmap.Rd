% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/aheatmap.R
\name{aheatmap}
\alias{aheatmap}
\title{A function to draw clustered heatmaps.}
\usage{
aheatmap(
  mat,
  color = bluered(100),
  kmeans_k = NA,
  breaks = NA,
  midpoint = NA,
  border_color = "grey60",
  cellwidth = NA,
  cellheight = NA,
  shrink = 0.92,
  scale = "row",
  clusterWithScaledData = FALSE,
  cluster_rows = TRUE,
  cluster_cols = TRUE,
  clustering_distance_rows = "correlation",
  clustering_distance_cols = "correlation",
  clustering_method = "ward",
  treeheight_row = ifelse(cluster_rows, 50, 0),
  treeheight_col = ifelse(cluster_cols, 50, 0),
  legend = TRUE,
  legend_breaks = NA,
  legend_labels = NA,
  annotation = NA,
  annotation_colors = NA,
  annoHeaderPosition = NA,
  annotation_legend = TRUE,
  drop_levels = TRUE,
  show_rownames = T,
  show_colnames = T,
  main = "",
  fontsize = 10,
  fontsize_row = fontsize,
  fontsize_col = fontsize,
  display_numbers = F,
  number_format = "\%.2f",
  number_rotation = 0,
  fontsize_number = 0.8 * fontsize,
  filename = NA,
  width = NA,
  height = NA,
  cexRow,
  cexCol,
  labRow = NA,
  labCol = NA,
  truncate = NA,
  q1 = 0.01,
  q2 = 0.99,
  Lower,
  Upper,
  returnTree = FALSE,
  ...
)
}
\arguments{
\item{mat}{numeric matrix of the values to be plotted.}

\item{color}{vector of colors used in heatmap.}

\item{kmeans_k}{the number of kmeans clusters to make, if we want to agggregate the 
rows before drawing heatmap. If NA then the rows are not aggregated.}

\item{breaks}{a sequence of numbers that covers the range of values in mat and is one 
element longer than color vector. Used for mapping values to colors. Useful, if needed 
to map certain values to certain colors, to certain values. If value is NA then the 
breaks are calculated automatically.}

\item{midpoint}{whether explicitely to match a mid point of the values to a mid-colour (usually white color) for the main image. 
This is useful when one what to hide result around i,e. 0 which
is not an interesting result.  This value is based on the matrix inputted for color matrix. Therefore, if scaled, it is on the scaled scale.}

\item{border_color}{color of cell borders on heatmap, use NA if no border should be 
drawn.}

\item{cellwidth}{individual cell width in points. If left as NA, then the values 
depend on the size of plotting window.}

\item{cellheight}{individual cell height in points. If left as NA, 
then the values depend on the size of plotting window.}

\item{shrink}{sometimes no space is left for margin; set shrink (percentage of current figure) will the image}

\item{scale}{character indicating if the values should be centered and scaled (first subtracts mean and then scaled by sd) in 
either the row direction or the column direction, or none. Corresponding values are 
\code{"row"}, \code{"column"} and \code{"none"}; By default, scale by row is applied which is mostly done in microarray data (scale each gene)}

\item{clusterWithScaledData}{this parameter controls whether the scaling of input matrix would affect clustering. By default this is set to be FALSE, which means
clustering only affects the color, not affecting the dendrogram and the numbers showing; if set to be TRUE, the scaled data would be used for clustering and coloring (as well
as the numbers shown) if necessary. It is recommended to set this as FALSE since scaling would attenuate the difference among samples and hence hide important pattern.}

\item{cluster_rows}{boolean values determining if rows should be clustered,}

\item{cluster_cols}{boolean values determining if columns should be clustered.}

\item{clustering_distance_rows}{distance measure used in clustering rows. Possible 
values are \code{"correlation"} for Pearson correlation and all the distances 
supported by \code{\link{dist}}, such as \code{"euclidean"}, etc. If the value is none 
of the above it is assumed that a distance matrix is provided.}

\item{clustering_distance_cols}{distance measure used in clustering columns. Possible 
values the same as for clustering_distance_rows.}

\item{clustering_method}{clustering method used. Accepts the same values as 
\code{\link{hclust}}.}

\item{treeheight_row}{the height of a tree for rows, if these are clustered. 
Default value 50 points.}

\item{treeheight_col}{the height of a tree for columns, if these are clustered. 
Default value 50 points.}

\item{legend}{logical to determine if legend should be drawn or not.}

\item{legend_breaks}{vector of breakpoints for the legend.}

\item{legend_labels}{vector of labels for the \code{legend_breaks}.}

\item{annotation}{data frame that specifies the annotations shown on top of the 
columns. Each row defines the features for a specific column. The columns in the data 
and rows in the annotation are matched using corresponding row and column names. Note 
that color schemes takes into account if variable is continuous or discrete.}

\item{annotation_colors}{list for specifying annotation track colors manually. It is 
possible to define the colors for only some of the features. Check examples for 
details. For categorical column bar, define a named vector so that color -category
will be correctly mapped; for continuous column bar, the specified color vector will be used
to interpolate colors for values inbetween.}

\item{annoHeaderPosition}{if left, which is the old one that adds annotation bar names at the left of the bars (c(3, 1)); now we add right so that the barname shows to the right. This is needed
when no row dendrogram where he header will not show completely.}

\item{annotation_legend}{boolean value showing if the legend for annotation tracks 
should be drawn.}

\item{drop_levels}{logical to determine if unused levels are also shown in the legend}

\item{show_rownames}{boolean specifying if column names are be shown.}

\item{show_colnames}{boolean specifying if column names are be shown.}

\item{main}{the title of the plot. set to "" so that there will be one line blank on top for good visual}

\item{fontsize}{base fontsize for the plot}

\item{fontsize_row}{fontsize for rownames (Default: fontsize)}

\item{fontsize_col}{fontsize for colnames (Default: fontsize)}

\item{display_numbers}{logical determining if the numeric values are also printed to 
the cells.}

\item{number_format}{format strings (C printf style) of the numbers shown in cells.}

\item{number_rotation}{rotation for number text display. default is 0
For example "\code{\%.2f}" shows 2 decimal places and "\code{\%.1e}" shows exponential 
notation (see more in \code{\link{sprintf}}).}

\item{fontsize_number}{fontsize of the numbers displayed in cells}

\item{filename}{file path where to save the picture. Filetype is decided by 
the extension in the path. Currently following formats are supported: png, pdf, tiff,
 bmp, jpeg. Even if the plot does not fit into the plotting window, the file size is 
calculated so that the plot would fit there, unless specified otherwise.}

\item{width}{manual option for determining the output file width in inches.}

\item{height}{manual option for determining the output file height in inches.}

\item{cexRow}{scale rownames by this factor.}

\item{cexCol}{scale colnames by this factor.}

\item{labRow}{labRow as in heatmap.2 Notice this is specified as the input matrix; if ordered, i.e. by clustering, the names should be the original order since it will be internally updated.}

\item{labCol}{labCol as in heatmap.2 Notice this is specified as the input matrix; if ordered, i.e. by clustering, the names should be the original order since it will be internally updated.}

\item{truncate}{}

\item{q1}{parameter q1 to truncByLimit}

\item{q2}{parameter q2 to truncByLimit}

\item{Lower}{parameter Lower to truncByQuantile()}

\item{Upper}{parameter Upper to truncByQuantile()}

\item{returnTree}{whether to return the clustering tree back. Default is FALSE}

\item{\dots}{graphical parameters for the text used in plot. Parameters passed to 
\code{\link{grid.text}}, see \code{\link{gpar}}.}
}
\value{
return the following list if returnTree is TRUE
\itemize{
	\item \code{tree_row} the clustering of rows as \code{\link{hclust}} object 
	\item \code{tree_col} the clustering of columns as \code{\link{hclust}} object
	\item \code{kmeans} the kmeans clustering of rows if parameter \code{kmeans_k} was 
specified 
}
}
\description{
A function to draw clustered heatmaps where one has better control over some graphical 
parameters such as cell size, etc.
}
\details{
Default distance is correlation for both row and column; linkage is set to ward by default. Scaling is applied to rows by default.
Modification has been made so that scaling only applies how the matrix is colored; the old matrix would be used to do the clustering.
For the annotation data frame to show as a column bar, categorical variables need to be a factor; the function can calculate default colors
But do not forget to have rownames of annotation data frame set to colnames of the matrix!

Added features: 
(1) truncate=NA, q1=0.01, q2=0.99, Lower, Upper: this is to truncate the valus to save color space. if truncate=FALSE, no truncation; if NA, it will be internally
set to TRUE if scale!='none'
(2) ...

The function also allows to aggregate the rows using kmeans clustering. This is 
advisable if number of rows is so big that R cannot handle their hierarchical 
clustering anymore, roughly more than 1000. Instead of showing all the rows 
separately one can cluster the rows in advance and show only the cluster centers. 
The number of clusters can be tuned with parameter kmeans_k.
}
\author{
Pan Tong \email{nickytong@gmail.com}
}
