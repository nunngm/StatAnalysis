% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/aheatmap.R
\name{create_bum}
\alias{create_bum}
\title{Create a bum 'object'}
\usage{
create_bum(
  pval,
  alphas = c(0.01, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5),
  FDR = NULL,
  maskPthr = 1,
  pcutoff = 0.05
)
}
\arguments{
\item{pval}{pvalue vector}

\item{alphas}{alpha values to create FDR table}

\item{FDR}{FDR value to be used for gene selection; if NA, guess it from FDR table}

\item{maskPthr}{when the P value contains a lot of 1's or close to 1, BUM model might fails. Thus we can mask out these P values
as NA so that we get a good estimate and selection for significant events. Default is 1, which means no masking is done.}

\item{pcutoff}{cutoff of p value to select indeces based on p values; default is 0.05}
}
\value{
a list
}
\description{
Given a vector of p values, fit BUM and calculate FDR table
}
\details{
Where the pval is highly significant, FDR tends to be small and the proportion of H0 genes is also small (pi0). It turns out the estimate of pi0
is still consistant (very similar to the qvalue package) and thus the Bum model fits really well even in this case. The problem arises when we want to achieve
a FDR larger than that is possible. i.e. maximum FDR=0.2 but specified FDR=0.3, in which case, the  cutoffSignificant() function will return a value larger than 1.
This is not a problem as long as we truncate this cutoff to 1 (notice that even using qvalue package will not achieve FDR=0.3). Finally, Bum model is very consistent with
the qvalue package.
}
